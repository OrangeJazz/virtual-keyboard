(()=>{function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}var n,e,i,a,s,l,r=document.querySelector("body"),c="",v={shiftOn:!1,altOn:!1,ctrlOn:!1,uppercase:!1,capsOn:!1,lang:"en",langs:["en","ru"]},o=v.langs.indexOf(v.lang),d=[[].concat([["`","~"],["1","!"],["2","@"],["3","#"],["4","$"],["5","%"],["6","^"],["7","&"],["8","*"],["9","("],["0",")"],["-","_"],["=","+"],["Backspace"],["Tab"],["q","Q"],["w","W"],["e","E"],["r","R"],["t","T"],["y","Y"],["u","U"],["i","I"],["o","O"],["p","P"],["[","{"],["]","}"],["Delete"],["Caps Lock"],["a","A"],["s","S"],["d","D"],["f","F"],["g","G"],["h","H"],["j","J"],["k","K"],["l","L"],[";",":"],["'",'"'],["\\","|"],["Enter"],["Shift"],["z","Z"],["x","X"],["c","C"],["v","V"],["b","B"],["n","N"],["m","M"],[",","<"],[".",">"],["/","?"],["Up"],["Shift"],["Ctrl"],["Alt"],[" "],["Alt"],["Ctrl"],["Left"],["Down"],["Right"]]),[].concat([["ё","Ё"],["1","!"],["2",'"'],["3","№"],["4",";"],["5","%"],["6",":"],["7","?"],["8","*"],["9","("],["0",")"],["-","_"],["=","+"],["Backspace"],["Tab"],["й","Й"],["ц","Ц"],["у","У"],["к","К"],["е","Е"],["н","Н"],["г","Г"],["ш","Ш"],["щ","Щ"],["з","З"],["х","Х"],["ъ","Ъ"],["Delete"],["Caps Lock"],["ф","Ф"],["ы","Ы"],["в","В"],["а","А"],["п","П"],["р","Р"],["о","О"],["л","Л"],["д","Д"],["ж","Ж"],["э","Э"],["\\","|"],["Enter"],["Shift"],["я","Я"],["ч","Ч"],["с","С"],["м","М"],["и","И"],["т","Т"],["ь","Ь"],["б","Б"],["ю","Ю"],[".",","],["Up"],["Shift"],["Ctrl"],["Alt"],[" "],["Alt"],["Ctrl"],["Left"],["Down"],["Right"]])],f=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","AltLeft","Space","AltRight","ControlRight","ArrowLeft","ArrowDown","ArrowRight"],u=["Backspace","Tab","Delete","CapsLock","Enter","ShiftLeft","ShiftRight","ArrowUp","ControlLeft","ControlRight","AltLeft","AltRight","ArrowRight","ArrowDown","ArrowLeft"];function b(){window.sessionStorage.setItem("lang","en")}function p(){window.sessionStorage.setItem("lang","ru")}function g(){return sessionStorage.getItem("lang")}var h,y=function(t){for(var e=0;e<n.length;e+=1){var i=[d[t][e][0]];n[e].innerText=i[0],n[e].setAttribute("keyname",n[e].innerText)}},L=function(t){for(var e=0;e<n.length;e+=1){if(d[t][e].length>1){var i=[d[t][e][1]];n[e].innerText=i[0]}if(1===d[t][e].length){var a=[d[t][e][0]];n[e].innerText=a[0]}n[e].setAttribute("keyname",n[e].innerText)}},S=function(t){for(var e=15;e<n.length;e+=1){if(d[t][e].length>1){var i=[d[t][e][1]];n[e].innerText=i[0]}if(1===d[t][e].length){var a=[d[t][e][0]];n[e].innerText=a[0]}n[e].setAttribute("keyname",n[e].innerText)}},C=function(){o=v.langs.indexOf(v.lang),y(o),a.textContent=v.lang.toUpperCase()};r.innerHTML='\n    <main class="container">\n    <div class="post">\n      <h1>Virtual Keyboard</h1>\n    </div>\n    <div class="screen">\n      <textarea name="text" class="text" cols="300" rows="10"></textarea>\n    </div>\n    <div class="keyboard eng">\n      <div class="wrapper">\n        <div class="row">\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn btn--double"></div>\n        </div>\n        <div class="row">\n          <div class="btn btn--plus-half"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn btn--plus-half"></div>\n        </div>\n        <div class="row">\n          <div class="btn btn--plus-half btn--caps-lock"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn btn--plus-half"></div>\n        </div>\n        <div class="row">\n          <div class="btn btn--double btn--left-shift"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn"></div>\n          <div class="btn btn--special"></div>\n          <div class="btn btn--arrowUp"></div>\n          <div class="btn btn--right-shift"></div>\n        </div>\n        <div class="row">\n          <div class="btn btn--plus-half btn--ctrl"></div>\n          <div class="btn btn--plus-half btn--alt"></div>\n          <div class="btn btn--space"></div>\n          <div class="btn btn--plus-half btn--alt"></div>\n          <div class="btn btn--plus-half btn--ctrl"></div>\n\n          <div class="btn btn--arrowLeft"></div>\n          <div class="btn btn--arrowDown"></div>\n          <div class="btn btn--arrowRight"></div>\n        </div>\n      </div>\n    </div>\n\n    <div class="post">\n      <p>\n        Current language: <span class="lang"></span>. To switch\n        language press \'Alt+Ctrl\'\n      </p>\n      <p class="status">Shift is <span class="shift-status"></span></p>\n      <p class="status">CapsLock is <span class="caps-status"></span></p>\n    </div>\n  </main>',h=document.querySelectorAll(".btn"),n=function(n){if(Array.isArray(n))return t(n)}(h)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(h)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var i=Object.prototype.toString.call(n).slice(8,-1);return"Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(n,e):void 0}}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),e=document.querySelector(".btn--caps-lock"),i=document.querySelector(".text"),a=document.querySelector(".lang"),s=document.querySelector(".shift-status"),l=document.querySelector(".caps-status"),v.shiftOn?s.textContent="On":s.textContent="Off",v.capsOn?l.textContent="On":l.textContent="Off",g()?(v.lang=g(),"en"===v.lang?b():p()):(v.lang="en",b()),C();var w=function(){"en"===v.lang?(v.lang="ru",p(),C()):(v.lang="en",b(),C())};window.addEventListener("keydown",(function(t){for(var a,r=t.code,d=0;d<f.length;d+=1)f[d]===r&&(a=d);"CapsLock"!==r&&n[a].classList.add("active"),u.includes(r)||(t.preventDefault(),c=n[a].getAttribute("keyname"),i.value+=c),"Tab"===r&&(t.preventDefault(),c="  ",i.value+=c),"Space"===r&&(t.preventDefault(),c=" ",i.value+=c),"CapsLock"===r&&(e.classList.toggle("active"),e.classList.contains("active")?(l.textContent="On",v.capsOn=!0,S(o)):(l.textContent="Off",v.capsOn=!1,y(o))),"ShiftLeft"!==r&&"ShiftRight"!==r||(s.textContent="On",v.shiftOn=!0,L(o)),"AltLeft"!==r&&"AltRight"!==r||(t.preventDefault(),v.altOn=!0,v.ctrlOn&&w()),"ControlLeft"!==r&&"ControlRight"!==r||(t.preventDefault(),v.ctrlOn=!0,v.altOn&&w())})),window.addEventListener("keyup",(function(t){for(var e,i=t.code,a=0;a<f.length;a+=1)f[a]===i&&(e=a);"CapsLock"!==i&&n[e].classList.remove("active"),"ShiftLeft"!==i&&"ShiftRight"!==i||(s.textContent="Off",v.shiftOn=!1,y(o)),"AltLeft"!==i&&"AltRight"!==i||(v.altOn=!1),"ControlLeft"!==i&&"ControlRight"!==i||(v.ctrlOn=!1)})),document.addEventListener("mousedown",(function(t){i.focus();var a=t.target;if(n.includes(a)){for(var r,d=0;d<n.length;d+=1)n[d]===a&&(r=d);var b,p,g=f[r];"CapsLock"!==g&&n[r].classList.add("active"),u.includes(g)||(t.preventDefault(),c=n[r].getAttribute("keyname"),i.value+=c),"Tab"===g&&(t.preventDefault(),c="  ",i.value+=c),"Space"===g&&(t.preventDefault(),c=" ",i.value+=c),"CapsLock"===g&&(e.classList.toggle("active"),e.classList.contains("active")?(l.textContent="On",v.capsOn=!0,S(o)):(l.textContent="Off",v.capsOn=!1,y(o))),"ShiftLeft"!==g&&"ShiftRight"!==g||(s.textContent="On",v.shiftOn=!0,L(o)),"AltLeft"!==g&&"AltRight"!==g||(t.preventDefault(),v.altOn=!0,v.ctrlOn&&w()),"ControlLeft"!==g&&"ControlRight"!==g||(t.preventDefault(),v.ctrlOn=!0,v.altOn&&w()),"Delete"===g&&(0===i.selectionStart?(b=i.selectionStart,i.value=i.value.slice(b+1),i.selectionStart=b):void 0===i.selectionStart||null===i.selectionStart?b=i.value.length:(b=i.selectionStart,i.value=i.value.slice(0,b)+i.value.slice(b+1),i.selectionStart=b)),"Enter"===g&&(t.preventDefault(),c="\n",i.value+=c),"ArrowLeft"===g&&(t.preventDefault(),c="←",i.value+=c),"ArrowRight"===g&&(t.preventDefault(),c="→",i.value+=c),"ArrowUp"===g&&(t.preventDefault(),c="↑",i.value+=c),"ArrowDown"===g&&(t.preventDefault(),c="↓",i.value+=c),"Backspace"===g&&(t.preventDefault(),i.selectionStart?(p=i.selectionStart,i.value=i.value.slice(0,p-1)+i.value.slice(p),i.selectionStart=p-1,i.selectionEnd=i.selectionStart):p=i.value.length)}})),document.addEventListener("mouseup",(function(t){var e=t.target;if(n.includes(e)){for(var i,a=0;a<n.length;a+=1)n[a]===e&&(i=a);var l=f[i];"CapsLock"!==l&&n[i].classList.remove("active"),"ShiftLeft"!==l&&"ShiftRight"!==l||(s.textContent="Off",v.shiftOn=!1,y(o)),"AltLeft"!==l&&"AltRight"!==l||(v.altOn=!1),"ControlLeft"!==l&&"ControlRight"!==l||(v.ctrlOn=!1)}}))})();